# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json

schema_version: 1

context:
  name: "gds-sigp"
  version: "2.0.0"

package:
  name: ${{ name }}
  version: ${{ version }}

source:
  url: https://git.ligo.org/cds/software/gds-sigp/-/archive/${{ version }}/${{ version }}.tar.gz
  sha256: 70267968a130dc9bebdda7c5ec89931a860227684471b7ceee6f1e7d10c46ba0 
  patches:
    - add_includes.patch
    - add_dl.patch

build:
  number: 0

requirements:
  build:
   - ${{ compiler('c') }}
   - ${{ compiler('cxx') }}
   - ${{ stdlib("c") }}
   - cmake
   - if: not win
     then:
       - make
       - pkg-config

  host:
   - fftw
   - expat
   - libexpat
   - zlib
   - if: win
     then:
       - pthreads-win32

tests:
  - script:
    - if: not win
      then:
         - test -f ${PREFIX}/lib/libgds-sigp${SHLIB_EXT}
         - test -f ${PREFIX}/include/gds-sigp/gdssigproc.h
      else:
         - IF NOT EXIST %PREFIX%\\Library\\bin\\gds-sigp%SHLIB_EXT% EXIT /B 1
         - IF NOT EXIST %PREFIX%\\Library\\include\\gds-sigp\\gdssigproc.h EXIT /B 1

about:
  homepage: https://git.ligo.org/cds/software/gds_sigp
  repository: https://git.ligo.org/cds/software/gds_sigp.git
  license: GPL-3.0-or-later
  license_family: GPL
  license_file:
    - COPYING
    - COPYING-GPL-3
  summary: Library for advinced LIGO signal processing

extra:
  recipe-maintainers:
    - evonreis
