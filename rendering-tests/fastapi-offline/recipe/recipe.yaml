# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
schema_version: 1

context:
  version: "1.7.5"

package:
  name: fastapi-offline
  version: ${{ version }}

source:
  - url: https://pypi.org/packages/source/f/fastapi-offline/fastapi_offline-${{ version }}.tar.gz
    sha256: 07a58cb8d8fab68ba625698414b4cac833bb2d94d82dc0fbc2a8519bee7af87d
    target_directory: dist
  - url: https://github.com/turettn/fastapi_offline/archive/refs/tags/v${{ version }}.tar.gz
    sha256: dd4b57a2073ed2f023b183fc8fb977a198d08cb05012cb142b2d7be951895af4
    target_directory: src
  # third-party licenses
  - url: https://raw.githubusercontent.com/tiangolo/fastapi/master/LICENSE
    sha256: 4ec89ffc81485b97fec584b2d4a961032eeffe834453894fd9c1274906cc744e
    file_name: fastapi-LICENSE-MIT
  - url: https://raw.githubusercontent.com/Redocly/redoc/master/LICENSE
    sha256: d3026d549cf68ab7355bcfa85877bf8f845b3334a7efbfdc63936432fb34ff0e
    file_name: redoc-LICENSE-MIT
  - url: https://raw.githubusercontent.com/swagger-api/swagger-ui/master/LICENSE
    sha256: cfc7749b96f63bd31c3c42b5c471bf756814053e847c10f3eb003417bc523d30
    file_name: swagger-ui-LICENSE-APACHE-2.0
  - url: https://raw.githubusercontent.com/swagger-api/swagger-ui/master/NOTICE
    sha256: 0d20d1adef18aee3f40dd258172155521ce702ac445cb5f7b7d60ed32dad2fb2
    file_name: swagger-ui-NOTICE-APACHE-2.0

build:
  number: 0
  noarch: python
  script:
    - cd dist
    - ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation --disable-pip-version-check

requirements:
  host:
    - fastapi >=0.99.0
    - pip
    - python ${{ python_min }}.*
    - setuptools
    - uvicorn-standard
  run:
    - fastapi >=0.99.0
    - python >=${{ python_min }}

tests:
  - python:
      imports: fastapi_offline
      pip_check: true
      python_version:
        - ${{ python_min }}.*
        - 3.14.*
  - files:
      source:
        - src/tests/
    requirements:
      run:
        - mypy
        - pytest-cov
        - python ${{ python_min }}.*
        - requests
        - starlette-full
    script:
      - pytest src/tests -vv --cov fastapi_offline --no-cov-on-fail --cov-report=term-missing:skip-covered --cov-fail-under=97
      - mypy --strict -m fastapi_offline

about:
  summary: FastAPI without reliance on CDNs for docs
  license: MIT
  license_file:
    - dist/LICENSE
    - fastapi-LICENSE-MIT
    - redoc-LICENSE-MIT
    - swagger-ui-LICENSE-APACHE-2.0
    - swagger-ui-NOTICE-APACHE-2.0
  homepage: https://github.com/turettn/fastapi_offline

extra:
  recipe-maintainers:
    - bollwyvl
