context:
  version: "685"

package:
  name: less
  version: ${{ version }}

source:
  url: https://github.com/gwsw/less/archive/refs/tags/v${{ version }}-rel.tar.gz
  sha256: dfade04bc449608218e7ac032d3c1a54054158a4a6b1eff7f1a18f8f0f67ce72

build:
  number: 1
  script:
    - if: win
      then:
        - nmake -f Makefile.wnm generated
        - nmake -f Makefile.wnm
        - mkdir %PREFIX%\bin
        - copy less.exe %PREFIX%\bin\
        - copy lesskey.exe %PREFIX%\bin\
      else:
        - make -f Makefile.aut distfiles
        - sh configure --prefix=${PREFIX} --with-regex=pcre2
        - make
        - make install

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ stdlib('c') }}
    - if: unix
      then:
        - autoconf
        - make
        - groff
  host:
    - if: unix
      then:
        - ncurses
        - pcre2

tests:
  - script:
      - less --version
      - lesskey --version
      - ${{ "lessecho --version" if unix }}

about:
  summary: A terminal based program for viewing text files
  description: |
    Less is a pager. A pager is a program that displays text files. Other pagers
    commonly in use are more and pg. Pagers are often used in command-line
    environments like the Unix shell and the MS-DOS command prompt to display
    files.
  license: GPL-3.0-only
  license_file:
    - LICENSE
    - COPYING
  homepage: https://www.greenwoodsoftware.com/less
  repository: https://github.com/gwsw/less
  documentation: https://www.greenwoodsoftware.com/less/faq.html

extra:
  recipe-maintainers:
    - tetov
