schema_version: 1

context:
  name: dspeed
  version: "2.1.2"
  python_min: '3.10'

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/${{ name[0] }}/${{ name }}/dspeed-${{ version }}.tar.gz
  sha256: 7c134e683f55d7957a5387baac4596fdd9a5fbac3fe8c28b478e8a3e4adfaa86

build:
  number: 0
  noarch: python
  script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation

requirements:
  host:
    - python ${{ python_min }}.*
    - pip
    - setuptools >=42.0.0
    - setuptools-scm >=3.4
  run:
    - python >=${{ python_min }}
    - pywavelets
    - colorlog
    - h5py >=3.2
    - iminuit
    - legend-pydataobj >=1.16.0
    - matplotlib-base
    - numba !=0.53,!=0.54.*
    - numpy >2
    - parse
    - pint
    - pyarrow
    - pyyaml
    - scipy
    - tqdm >=4.27
    - dbetto
tests:
  - python:
      imports:
        - dspeed
      pip_check: true
      python_version: ${{ python_min }}.*
  - requirements:
      run:
        - python ${{ python_min }}.*
        - pip
    script:
      - pip list
      - dspeed --help

about:
  license: GPL-3.0-only
  license_file: LICENSE
  summary: Fast Digital Signal Processing for particle detectors in Python
  description: |
    DSPeed (pronounced dee-ess-speed) is a python-based package that performs
    bulk, high-performance digital signal processing (DSP) of time-series data
    such as digitized waveforms.
    This package is part of the pygama scientific computing suite.

    DSPeed enables the user to define an arbitrary chain of vectorized signal
    processing routines that can be applied in bulk to waveforms and other
    data provided using the LH5-format.
    These routines can include numpy ufuncs, custom functions accelerated with
    numba, or other arbitrary functions.
    DSPeed will carefully manage file I/O to optimize memory usage and performance.
    Processing chains are defined using highly portable JSON files that can be
    applied to data from multiple digitizers.
  homepage: https://github.com/legend-exp/dspeed
  repository: https://github.com/legend-exp/dspeed
  documentation: https://dspeed.readthedocs.io/

extra:
  recipe-maintainers:
    - gipert
    - matthewfeickert
