schema_version: 1

context:
  name: google-cloud-datastore
  version: 2.23.0

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://pypi.org/packages/source/${{ name[0] }}/${{ name }}/${{ name | replace('-', '_') }}-${{ version }}.tar.gz
  sha256: 80049883a4ae928fdcc661ba6803ec267665dc0e6f3ce2da91441079a6bb6387

build:
  number: 1
  noarch: python
  script: ${{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation

requirements:
  host:
    - python ${{ python_min }}.*
    - pip
    - setuptools
  run:
    # restricting to python <3.14 for now because of grpcio requirement currently
    # not available on conda-forge
    - python >=${{ python_min }},<3.14
    - google-api-core >=1.34.0,<3.0.0,!=2.0.*,!=2.1.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,!=2.10.*
    - google-api-core-grpc
    - google-auth >=2.14.1,<3.0.0,!=2.24.0,!=2.25.0
    - google-cloud-core >=1.4.0,<3.0.0
    # most restrictive constraint for python >= 3.13
    - proto-plus >=1.25.0,<2.0.0
    - protobuf >=3.20.2,<7.0.0,!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5
    # version for python <3.14, since the required version for python >=3.14
    # (grpcio >=1.75.1) is not on conda-forge yet
    - grpcio >=1.38.0,<2.0.0

tests:
  - python:
      imports:
        - google
        - google.cloud
        - google.cloud.datastore
        - google.cloud.datastore_v1
        - google.cloud.datastore_admin_v1
      python_version: ${{ python_min }}.*
  - requirements:
      run:
        - python ${{ python_min }}.*
        - pip
    script:
      - pip check

about:
  license: Apache-2.0
  license_file: LICENSE
  summary: Python Client for Google Cloud Datastore
  description: |
    Google Cloud Datastore API is a fully managed, schemaless database for
    storing non-relational data. Cloud Datastore automatically scales with
    your users and supports ACID transactions, high availability of reads
    and writes, strong consistency for reads and ancestor queries, and
    eventual consistency for all other queries.
  homepage: https://github.com/googleapis/python-datastore
  repository: https://github.com/googleapis/python-datastore
  documentation: https://googleapis.dev/python/datastore/latest

extra:
  recipe-maintainers:
    - xylar
    - mathiaseitz
    - trendelkampschroer
    - parthea
